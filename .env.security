# üõ°Ô∏è GUARDIAN AI CRM - ADVANCED SECURITY FRAMEWORK
# ===================================================
# Multi-Layer Security Implementation for Enterprise-Grade Protection

# üîê SECURITY LAYER 1: JWT & ACCESS CONTROL
# ==========================================

# JWT Secret Rotation (256-bit minimum)
JWT_SECRET_PRIMARY=enterprise_guardian_crm_jwt_primary_key_2024_ultra_secure_256bit_rotation_enabled
JWT_SECRET_BACKUP=enterprise_guardian_crm_jwt_backup_key_2024_ultra_secure_256bit_for_rotation

# Encryption Keys (AES-256)
ENCRYPTION_KEY_PRIMARY=G9k2mP8vN5qR7wE3yU4tI6oL1sD9fG2h
ENCRYPTION_KEY_BACKUP=H1k3nQ9wP6rS8xF4zV5uJ7pM2tE0hI3j

# API Rate Limiting
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_FAILED_REQUESTS=true

# üîê SECURITY LAYER 2: DATABASE PROTECTION
# ==========================================

# Connection Security
DB_SSL_MODE=require
DB_CONNECTION_LIMIT=20
DB_IDLE_TIMEOUT=30000
DB_QUERY_TIMEOUT=60000

# Row Level Security Enforcement
RLS_ENFORCE_FOR_ALL_TABLES=true
RLS_BYPASS_ROLE_ALLOWED=false

# üîê SECURITY LAYER 3: API PROTECTION
# ====================================

# CORS Security
CORS_ORIGIN_WHITELIST=https://crm-ai-rho.vercel.app,https://localhost:3000
CORS_METHODS_ALLOWED=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS_ALLOWED=Authorization,Content-Type,x-organization-id,x-user-role

# CSP (Content Security Policy)
CSP_DEFAULT_SRC="'self'"
CSP_SCRIPT_SRC="'self' 'unsafe-inline' https://cdn.jsdelivr.net"
CSP_STYLE_SRC="'self' 'unsafe-inline'"
CSP_IMG_SRC="'self' data: https:"

# üîê SECURITY LAYER 4: MONITORING & LOGGING
# ===========================================

# Security Monitoring
SECURITY_LOG_LEVEL=WARN
FAILED_LOGIN_THRESHOLD=5
FAILED_LOGIN_LOCKOUT_MINUTES=30
SECURITY_ALERT_EMAIL=security@guardian-ai-crm.com

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=90
AUDIT_SENSITIVE_DATA_MASK=true

# üîê SECURITY LAYER 5: INTRUSION DETECTION
# ==========================================

# IP Whitelisting
IP_WHITELIST_ENABLED=true
IP_WHITELIST_STRICT_MODE=true
GEO_BLOCKING_ENABLED=true
GEO_ALLOWED_COUNTRIES=IT,US,GB,DE,FR

# Threat Detection
BRUTE_FORCE_PROTECTION=true
SQL_INJECTION_DETECTION=true
XSS_PROTECTION_ENABLED=true
DDOS_PROTECTION_ENABLED=true

# üìä PERFORMANCE & RELIABILITY
# =============================

# Caching Security
REDIS_AUTH_ENABLED=true
CACHE_ENCRYPTION_ENABLED=true
SESSION_SECURE_COOKIES=true
SESSION_HTTPONLY_COOKIES=true

# Health Monitoring
HEALTH_CHECK_ENDPOINT=/api/health
UPTIME_MONITORING_ENABLED=true
PERFORMANCE_METRICS_ENABLED=true

# üöÄ DEPLOYMENT SECURITY
# =======================

# Environment Segregation
ENVIRONMENT=production
DEPLOYMENT_STAGE=enterprise
SECURITY_COMPLIANCE_LEVEL=SOC2

# Backup & Recovery
AUTOMATED_BACKUP_ENABLED=true
BACKUP_ENCRYPTION_ENABLED=true
DISASTER_RECOVERY_ENABLED=true

# Secret Management
SECRET_ROTATION_ENABLED=true
SECRET_ROTATION_INTERVAL_DAYS=30
SECRET_AUDIT_LOG_ENABLED=true